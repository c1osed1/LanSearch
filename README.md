# Changelog - LanSearch Extension (Chrome)

## Version 1.3.78 23-10-2025

- **НОВОЕ**: вот бы пивка

## Version 1.3.77 15-10-2025
- **НОВОЕ**: Кнопка "Игнорирование энергосбережения" в dropdown меню ПК
- **НОВОЕ**: Кнопка "Управлять" под кнопкой "Разблок." на карточках ПК
- **ИСПРАВЛЕНО**: Bootstrap-select и другие dropdown меню теперь работают корректно на всех страницах
- **ИСПРАВЛЕНО**: Скрытие чекбоксов и комментариев работает только на странице `/all_clubs_pc/`
- **ИСПРАВЛЕНО**: Удалены лишние `<br>` теги из карточек ПК
- **ТЕХНИЧЕСКОЕ**: Ограничен код работы с dropdown меню только страницей ПК
- **ТЕХНИЧЕСКОЕ**: Улучшена специфичность CSS селекторов для предотвращения конфликтов

### Скоро:
- **ПЛАНИРУЕТСЯ**: Просмотр измененных файлов за последние 24 часа на ПК
- **ПЛАНИРУЕТСЯ**: Отображение запущенных программ на ПК в текущий момент

## Version 1.3.76 15-10-2025
- **НОВОЕ**: Ускорение
- **НОВОЕ**: Поддержка F5
- **НОВОЕ**: кнопка обновления CMD


## Version 1.3.71 15-10-2025
- **НОВОЕ**: Ускорение

- **НОВОЕ**: Обновление цветов текста
- **НОВОЕ**: Исправление скрытия чекбоксов и комментариев
- **НОВОЕ**: обновляторы 3000
## Version 1.3.7 12-10-2025
- **НОВОЕ**: Поиск гостей на главной странице при открытия домена
- **НОВОЕ**: Пополнение списание основного баланса и бонусного

## Version 1.3.6- 11-10-2025
- **НОВОЕ**: Кастомный WebSocket мониторинг для страниц `/freenas_wrap/` и `/pc_tasks/`
- **НОВОЕ**: Автоматическое получение статусов ПК через WebSocket соединение
- **НОВОЕ**: Отображение технических статусов: "Руч.Разлок", "Тех.режим", "Свободен", "Занят", "Офлайн"
- **НОВОЕ**: Кнопка "Запросить состояние ПК" для обновления статусов
- **НОВОЕ**: Мгновенное обновление таблицы без задержек и alert'ов
- **ТЕХНИЧЕСКОЕ**: Прямое подключение к WebSocket API с обработкой команд `showConfig`
- **ТЕХНИЧЕСКОЕ**: Автоматическое определение пустых ячеек статуса и запрос данных только для них

## Version 1.3.28 - 08-10-2025
- **НОВОЕ**: Автоматическое управление настройкой "Обход модальных окон" при работе с режимом выбора ПК
- **УЛУЧШЕНО**: При активации режима выбора ПК обход модальных окон автоматически отключается для корректной работы
- **УЛУЧШЕНО**: При отмене режима выбора настройка "Обход модальных окон" восстанавливается в исходное состояние

## Version 1.3.27+++ - 08-10-2025
- **НОВОЕ**: Кастомные стили для карточек ПК (Компактные)
- **НОВОЕ**: Переключатель "Современные стили карт ПК" в popup для управления стилями
- **НОВОЕ**: Оптимизация таблиц с сокращением названий колонок для экономии места
- **НОВОЕ**: Переключатель "Оптимизация таблиц" для страниц `/guests_search/`
- **НОВОЕ**: Скрытие чекбоксов "Посадка" и "Бронь" на карточках ПК
- **НОВОЕ**: Переключатель "Скрыть чекбоксы ПК" для экономии места на картах
- **НОВОЕ**: Скрытие полей комментариев на карточках ПК
- **НОВОЕ**: Переключатель "Скрыть комментарии ПК" для компактного отображения
- **НОВОЕ**: Поддержка темной темы для всех новых стилей
- **ИСПРАВЛЕНО**: Убраны все уведомления при открытии сайта для тихой работы расширения
- **ИСПРАВЛЕНО**: Удалены назойливые сообщения "Комментарии ПК скрыты", "Чекбоксы ПК скрыты" и другие
- **УЛУЧШЕНО**: Современный дизайн popup с белым и темно-серым фоном без анимаций
- **УЛУЧШЕНО**: Упрощен интерфейс popup с четкими границами и современными стилями
- **ТЕХНИЧЕСКОЕ**: Исправлена ошибка с несуществующим элементом `activateBtn` в popup.js

## Version 1.3.26 - 07-10-2025
- **НОВОЕ**: Добавлена проверка статуса подмены дисков для ПК
- **НОВОЕ**: Отображение статуса подмены с цветовой индикацией (зеленый/красный)
- **НОВОЕ**: Автоматическое получение данных о дисках с сервера
- **НОВОЕ**: Интеграция с API `/freenas_wrap/` для получения актуальной информации
- **НОВОЕ**: Отображение даты снимка диска и статуса подмены в карточке ПК
- **УЛУЧШЕНО**: Оптимизация интерфейса карточек ПК

## Version 1.3.25 - 07-10-2025
- **НОВОЕ**: Добавлена интеграция панели массового выбора ПК для раздела `/all_clubs_pc/`
- **НОВОЕ**: Минималистичная встроенная панель в левый блок страницы
- **НОВОЕ**: Панель появляется после нажатия кнопки "Выбрать" и скрывается при "Отмена"
- **НОВОЕ**: Поддержка выбора ПК по диапазонам и номерам (аналогично `/pc_tasks/`)
- **НОВОЕ**: Быстрые действия: "Все", "Очистить", "Инверт"
- **НОВОЕ**: Адаптивный дизайн с поддержкой темной темы
- **УЛУЧШЕНО**: Компактное расположение кнопок для минимизации занимаемого пространства

## Version 1.3.23 - 06-10-2025
- изменен визуал, плавающего меню
## Version 1.3.22 - 06-10-2025
- **НОВОЕ**: Добавлена плавающая панель массового выбора ПК для страницы `/pc_tasks/`
- **НОВОЕ**: Поддержка диапазонов выбора ПК (например: `2-10`, `2,5,8-12`)
- **НОВОЕ**: Поддержка различных форматов номеров ПК: `1`, `PC1`, `PC01`, `pc-1` и т.д.
- **НОВОЕ**: Быстрые кнопки выбора: "Все", "Свободные", "Очистить", "Инверт"
- **НОВОЕ**: Две основные кнопки: "Выбрать" и "Снять" для работы с диапазонами
- **НОВОЕ**: Панель можно перетаскивать и сворачивать/разворачивать
- **НОВОЕ**: Автоматическое определение таблиц ПК на странице
- **НОВОЕ**: Визуальные уведомления о результатах выбора
- **УЛУЧШЕНО**: Интеллектуальное извлечение номера ПК из любого текстового формата

## Version 1.3.21 - 29-09-2025
- **ИСПРАВЛЕНО**: Перетаскивание избранных вкладок теперь корректно сохраняет порядок
- **ИСПРАВЛЕНО**: Порядок избранных сохраняется после перезагрузки страницы
- **ИСПРАВЛЕНО**: Улучшена система кэширования для синхронизации между операциями
- **ИСПРАВЛЕНО**: Исправлено извлечение заголовков карточек для правильного сопоставления

## Version 1.3.20 - 29-09-2025
- **НОВОЕ**: Увеличен лимит избранных вкладок с 5 до 20 штук
- **НОВОЕ**: Добавлена функциональность перетаскивания избранных вкладок
- **НОВОЕ**: Визуальные эффекты при перетаскивании (прозрачность, поворот, тени)
- **НОВОЕ**: Handle для перетаскивания (⋮⋮) с появлением при наведении
- **НОВОЕ**: Система drag & drop с поддержкой изменения порядка
- **НОВОЕ**: Автоматическое сохранение нового порядка в chrome.storage.local

## Version 1.3.19 - 29-09-2025
- Исправлен баг с циклом обработок кнопок
- Добавлен удобное меню выбора ПК(МАССОВАЯ)


## Version 1.3.17 - 12-05-2025
- **ИСПРАВЛЕНИЕ**: Добавлена поддержка команд LockPS и UnLockPS в обходе модалок
- Исправлена проблема с кнопками Lock/UnLock, которые не вызывали API запросы
- Улучшена функция extractButtonParamsFromDiv для поиска UUID в родительских элементах
- Добавлены специфичные сообщения об успехе и ошибках для всех команд блокировки/разблокировки
- Исправлена проверка атрибута data-lan-search-replaced в обработчике кликов

## Version 1.3.15 - 12-05-2025
- Исправлен баг с поиском по меню

## Version 1.3.13 - 05-09-2025
- Включение обхода модальных окон Тех.Старт/стоп и блокировки/разблокировки ПК
- Добавлена система проверки обновлений
- Обновлены домены для поддержки

## Version 1.3.12 - 05-09-2025
- Включение старой работы Тех.Стар/стоп

## Version 1.3.11 - 27-08-2025

### Мелкие исправления
- Поддержка большего количества доменов для работы расширения
- Общие улучшения стабильности и совместимости


## Version 1.3.10 - 23-08-2025
- Исправлена работа

## Version 1.3.9 - 22-08-2025

### Улучшения
- **Упрощена система темной темы**: Убраны агрессивные переопределения стилей из JavaScript
- **Улучшена производительность**: Теперь тема применяется только через CSS (theme.css)
- **Оверлей загрузки**: Теперь показывается только внутри .content-wrapper, а не на весь экран
- **Стабильность**: Устранены проблемы с постоянным обновлением стилей

### Технические детали
- Удалены функции forceOverrideAllStyles(), overrideCSSVariables(), createOverrideStyles()
- Упрощена функция applyThemeToNewElements() - теперь только устанавливает data-theme
- Убрано периодическое применение стилей каждые 2 секунды
- Оверлей загрузки теперь position: absolute вместо fixed

## Version 1.3.8 - 15-08-2025

### Новые функции
- **Темная тема**: Добавлена поддержка темной темы с переключателем в popup окне
- **Автоматическое применение**: Тема автоматически применяется ко всем страницам, где работает расширение
- **Сохранение настроек**: Выбранная тема сохраняется в браузере и синхронизируется между устройствами

### Технические детали
- CSS переменные для управления цветами
- Адаптация всех компонентов расширения под темную тему
- Поддержка всех элементов интерфейса (popup, поисковая панель, карточки вкладок)
- Интеграция с chrome.storage.sync для хранения настроек темы

### Файлы
- `theme.css` - CSS переменные и стили для темной темы

## Version 1.3.7 - 15-08-2025

### Дополнение

- На избранные можно назначить цвета.

## Version 1.3.6 - 10-08-2025

### Исправление

- У вкладки теперь домен вместо текста

## Version 1.3.5 - 10-08-2025

### Новые функции
- **Система проверки обновлений**: Добавлена кнопка проверки обновлений в popup, которая проверяет последний коммит с GitHub
- **Автоматическая проверка**: При открытии popup автоматически проверяется наличие обновлений
- **Скачивание обновлений**: Кнопка для скачивания последней версии с GitHub

### Технические детали
- Интеграция с GitHub API для получения информации о последних коммитах
- Сохранение информации о последнем известном коммите в chrome.storage.local
- Сравнение дат коммитов для определения наличия обновлений
- Добавлено разрешение для доступа к api.github.com



## Version 1.2.5 - 10-08-2025

## Визуал
- Перемещение поиска в Аккордион

## Version 1.2.0 - 10-08-2025
### Критические изменения
- **Переход на chrome.storage.local**: Заменен localStorage на chrome.storage.local для обеспечения общего доступа к данным избранных и недавних вкладок на всех подходящих доменах
- **Добавлено разрешение storage**: В manifest.json добавлено разрешение "storage" для доступа к API хранилища расширения

### Исправления
- **Кросс-доменное хранение**: Теперь избранные и недавние вкладки сохраняются глобально в расширении и доступны на всех доменах с "langame" или "cls"
- **Асинхронные операции**: Все операции с хранилищем теперь асинхронные для корректной работы с chrome.storage.local
- **Безопасность**: Заменены все использования innerHTML на textContent для предотвращения XSS атак

### Технические детали
- Использование Promise-based API для всех операций с хранилищем
- Обновлены методы: getRecentTabs(), getFavoriteTabs(), addToFavorites(), removeFromFavorites(), isFavorite()
- Новые методы для работы с цветами: setFavoriteColor(), removeFavoriteColor()
- Сохранена обратная совместимость с существующими функциями
- Все эмодзи иконки теперь устанавливаются через textContent вместо innerHTML

### Цветовая система для избранных
Доступные цвета:
- 🔴 Красный (#ff6b6b)
- 🟠 Оранжевый (#ffa726)
- 🟡 Желтый (#ffd54f)
- 🟢 Зеленый (#66bb6a)
- 🔵 Голубой (#4fc3f7)
- 🔵 Синий (#42a5f5)
- 🟣 Фиолетовый (#ab47bc)
- 🩷 Розовый (#ec407a)

Для установки цвета:
1. Добавьте вкладку в избранное (нажмите на звездочку ⭐)
2. Нажмите на кнопку палитры 🎨 рядом со звездочкой
3. Выберите нужный цвет из палитры
4. Для удаления цвета выберите опцию "Без цвета"


### Новые функции
- **Отслеживание последних вкладок**: Автоматическое сохранение последних 10 использованных вкладок
- **Система избранных**: Возможность добавлять до 5 вкладок в избранное с помощью звездочки
- **Цветовая система для избранных**: Возможность присваивать разные цвета избранным вкладкам для лучшей организации
- **Отображение на главной странице**: Секция "Последние используемые вкладки" между оплатой и предложениями партнеров
- **Интерфейс popup**: Отображение недавних и избранных вкладок в popup расширения
- **Централизованное определение доменов**: Функции для определения подходящих доменов (langame, cls) и их поддоменов

### Изменения
- **manifest.json**: Добавлен recent-tabs.js в content_scripts
- **content.js**: Интеграция с RecentTabsManager для отслеживания и отображения
- **background.js**: Упрощен, popup теперь управляет активацией
- **recent-tabs.js**: Новый модуль для управления вкладками с функциями определения доменов

### Технические детали
- Использование localStorage для хранения данных
- Извлечение иконок из CSS :before стилей
- Fallback на эмодзи иконки
- Hover эффекты и уведомления
- Модульная архитектура с RecentTabsManager классом

### Структура файлов
```
LanSearch/
├── manifest.json
├── popup.html
├── popup.js
├── content.js
├── background.js
├── recent-tabs.js
└── icons/
```

### Функции определения доменов
- `isSuitableDomain(hostname)` - проверка конкретного домена
- `getCurrentDomain()` - получение текущего домена
- `isCurrentDomainSuitable()` - проверка текущего домена
- `getSuitableDomains()` - список всех подходящих доменов
- `isSuitableDomainWithSubdomains(hostname)` - проверка с учетом поддоменов
